<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio Value Calculator</title>
    <link rel="manifest" href="manifest.json">
   <meta name="theme-color" content="#667eea">
   <meta name="apple-mobile-web-app-capable" content="yes">
   <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
   <link rel="apple-touch-icon" href="icon-512.png">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 30px auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        h1 {
            text-align: center;
            margin-bottom: 20px;
        }
        .controls {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            gap: 30px;
            justify-content: center;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .control-group label {
            font-size: 0.9em;
            font-weight: bold;
            opacity: 0.9;
        }
        .control-group select {
            padding: 10px 15px;
            font-size: 1em;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.9);
            cursor: pointer;
            min-width: 150px;
        }
        .price-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }
        .price-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 1px solid rgba(255, 255, 255, 0.18);
        }
        .asset-name {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            opacity: 0.9;
        }
        .price {
            font-size: 1.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        .unit-label {
            font-size: 0.8em;
            opacity: 0.7;
            margin-bottom: 15px;
        }
        .quantity-input {
            margin: 15px 0;
        }
        .quantity-input input {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.9);
            text-align: center;
            box-sizing: border-box;
        }
        .quantity-input input:focus {
            outline: none;
            border-color: rgba(255, 255, 255, 0.6);
        }
        .total-value {
            font-size: 1.3em;
            font-weight: bold;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 2px solid rgba(255, 255, 255, 0.3);
            color: #4ade80;
        }
        .change {
            font-size: 0.9em;
            margin-top: 10px;
        }
        .positive { color: #4ade80; }
        .negative { color: #f87171; }
        .loading {
            opacity: 0.6;
            font-style: italic;
        }
        .grand-total {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        .grand-total-label {
            font-size: 1.2em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        .grand-total-value {
            font-size: 3em;
            font-weight: bold;
            color: #4ade80;
        }
        .last-update {
            text-align: center;
            margin-top: 20px;
            opacity: 0.7;
            font-size: 0.9em;
        }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8809215251716678"
     crossorigin="anonymous"></script>
</head>
<body>
    <h1>ðŸ’° Portfolio Value Calculator</h1>
    
    <div class="controls">
        <div class="control-group">
            <label for="currency">Currency</label>
            <select id="currency" onchange="fetchPrices()">
                <option value="USD">USD ($)</option>
                <option value="EUR">EUR (â‚¬)</option>
                <option value="GBP">GBP (Â£)</option>
                <option value="AUD">AUD (A$)</option>
                <option value="CAD">CAD (C$)</option>
            </select>
        </div>
        
        <div class="control-group">
            <label for="metal-unit">Gold/Silver Unit</label>
            <select id="metal-unit" onchange="updateMetalPrices()">
                <option value="oz">Troy Ounce (oz)</option>
                <option value="gram">Gram (g)</option>
                <option value="kg">Kilogram (kg)</option>
            </select>
        </div>
    </div>
    
    <div class="price-grid">
        <div class="price-card">
            <div class="asset-name">ðŸª™ Gold</div>
            <div class="price loading" id="gold-price">Loading...</div>
            <div class="unit-label" id="gold-unit"></div>
            <div class="change" id="gold-change"></div>
            <div class="quantity-input">
                <input type="number" id="gold-quantity" placeholder="Enter quantity" 
                       step="0.01" min="0" value="0" oninput="calculateTotals()">
            </div>
            <div class="total-value" id="gold-total">-</div>
        </div>
        
        <div class="price-card">
            <div class="asset-name">ðŸ¥ˆ Silver</div>
            <div class="price loading" id="silver-price">Loading...</div>
            <div class="unit-label" id="silver-unit"></div>
            <div class="change" id="silver-change"></div>
            <div class="quantity-input">
                <input type="number" id="silver-quantity" placeholder="Enter quantity" 
                       step="0.01" min="0" value="0" oninput="calculateTotals()">
            </div>
            <div class="total-value" id="silver-total">-</div>
        </div>
        
        <div class="price-card">
            <div class="asset-name">â‚¿ Bitcoin</div>
            <div class="price loading" id="btc-price">Loading...</div>
            <div class="unit-label">per BTC</div>
            <div class="change" id="btc-change"></div>
            <div class="quantity-input">
                <input type="number" id="btc-quantity" placeholder="Enter quantity" 
                       step="0.00000001" min="0" value="0" oninput="calculateTotals()">
            </div>
            <div class="total-value" id="btc-total">-</div>
        </div>
        
        <div class="price-card">
            <div class="asset-name">â—Ž XRP</div>
            <div class="price loading" id="xrp-price">Loading...</div>
            <div class="unit-label">per XRP</div>
            <div class="change" id="xrp-change"></div>
            <div class="quantity-input">
                <input type="number" id="xrp-quantity" placeholder="Enter quantity" 
                       step="0.01" min="0" value="0" oninput="calculateTotals()">
            </div>
            <div class="total-value" id="xrp-total">-</div>
        </div>
    </div>
    
    <div class="grand-total">
        <div class="grand-total-label">Total Portfolio Value</div>
        <div class="grand-total-value" id="grand-total">-</div>
    </div>
    
    <div class="last-update" id="last-update"></div>

    <script>
        const METAL_API_KEY = 'af21340bb30ac15735963138ff67342a';
        // Store the raw prices
        let rawPrices = {
            gold: { price: null, change: null },
            silver: { price: null, change: null },
            btc: { price: null, change: null },
            xrp: { price: null, change: null }
        };
        
        let currentCurrency = 'USD';
        
        // Conversion rates (from troy ounce)
        const conversions = {
            'oz': 1,           
            'gram': 0.03215,   
            'kg': 32.1507      
        };
        
        // Currency symbols
        const currencySymbols = {
            'USD': '$',
            'EUR': 'â‚¬',
            'GBP': 'Â£',
            'AUD': 'A$',
            'CAD': 'C$'
        };
        
        async function fetchPrices() {
    currentCurrency = document.getElementById('currency').value;
    
    // Fetch metals from MetalpriceAPI
    try {
        const metalsResponse = await fetch(
            `https://api.metalpriceapi.com/v1/latest?api_key=${METAL_API_KEY}&base=${currentCurrency}&currencies=XAU,XAG`
        );
        const metalsData = await metalsResponse.json();
        
        if (metalsData.success && metalsData.rates) {
            // MetalpriceAPI returns rates as 1/price, so we need to invert them
            if (metalsData.rates.XAU) {
                const goldPrice = 1 / metalsData.rates.XAU;
                rawPrices.gold = {
                    price: goldPrice,
                    change: 0
                };
            }
            
            if (metalsData.rates.XAG) {
                const silverPrice = 1 / metalsData.rates.XAG;
                rawPrices.silver = {
                    price: silverPrice,
                    change: 0
                };
            }
        }
        
        updateMetalPrices();
        
    } catch (error) {
        console.error('Error fetching metal prices:', error);
    }
    
    // Fetch crypto from CoinGecko
    try {
        const cryptoCurrency = currentCurrency.toLowerCase();
        const cryptoResponse = await fetch(
            `https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ripple&vs_currencies=${cryptoCurrency}&include_24hr_change=true`
        );
        const cryptoData = await cryptoResponse.json();
        
        if (cryptoData.bitcoin) {
            rawPrices.btc = {
                price: cryptoData.bitcoin[cryptoCurrency],
                change: cryptoData.bitcoin[`${cryptoCurrency}_24h_change`]
            };
            updatePrice('btc', rawPrices.btc.price, rawPrices.btc.change);
        }
        
        if (cryptoData.ripple) {
            rawPrices.xrp = {
                price: cryptoData.ripple[cryptoCurrency],
                change: cryptoData.ripple[`${cryptoCurrency}_24h_change`]
            };
            updatePrice('xrp', rawPrices.xrp.price, rawPrices.xrp.change);
        }
        
    } catch (error) {
        console.error('Error fetching crypto prices:', error);
    }
    
    calculateTotals();
    
    const now = new Date().toLocaleString();
    document.getElementById('last-update').textContent = `Last updated: ${now} â€¢ Live prices`;
}
        
        async function getExchangeRate(currency) {
            if (currency === 'USD') return 1;
            
            try {
                const response = await fetch(
                    `https://api.exchangerate-api.com/v4/latest/USD`
                );
                const data = await response.json();
                return data.rates[currency] || 1;
            } catch (error) {
                // Fallback exchange rates
                const fallback = {'EUR': 0.92, 'GBP': 0.79, 'AUD': 1.52, 'CAD': 1.36};
                return fallback[currency] || 1;
            }
        }
        
        function updateMetalPrices() {
            const unit = document.getElementById('metal-unit').value;
            const conversion = conversions[unit];
            
            if (rawPrices.gold.price) {
                const convertedPrice = rawPrices.gold.price / conversion;
                updatePrice('gold', convertedPrice, rawPrices.gold.change);
                updateUnitLabel('gold', unit);
            }
            
            if (rawPrices.silver.price) {
                const convertedPrice = rawPrices.silver.price / conversion;
                updatePrice('silver', convertedPrice, rawPrices.silver.change);
                updateUnitLabel('silver', unit);
            }
            
            calculateTotals();
        }
        
        function updatePrice(asset, price, change) {
            const priceElement = document.getElementById(`${asset}-price`);
            const changeElement = document.getElementById(`${asset}-change`);
            const symbol = currencySymbols[currentCurrency];
            
            priceElement.textContent = `${symbol}${price.toLocaleString(undefined, {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            })}`;
            priceElement.classList.remove('loading');
            
            if (change !== undefined && change !== null) {
                const changeClass = change >= 0 ? 'positive' : 'negative';
                const changeSymbol = change >= 0 ? 'â–²' : 'â–¼';
                changeElement.textContent = `${changeSymbol} ${Math.abs(change).toFixed(2)}%`;
                changeElement.className = `change ${changeClass}`;
            }
        }
        
        function updateUnitLabel(asset, unit) {
            const unitElement = document.getElementById(`${asset}-unit`);
            const unitNames = {
                'oz': 'per troy ounce',
                'gram': 'per gram',
                'kg': 'per kilogram'
            };
            unitElement.textContent = unitNames[unit];
        }
        
        function calculateTotals() {
            const symbol = currencySymbols[currentCurrency];
            const unit = document.getElementById('metal-unit').value;
            const conversion = conversions[unit];
            
            let grandTotal = 0;
            
            // Calculate Gold
            const goldQty = parseFloat(document.getElementById('gold-quantity').value) || 0;
            if (rawPrices.gold.price && goldQty > 0) {
                const goldPrice = rawPrices.gold.price / conversion;
                const goldTotal = goldQty * goldPrice;
                document.getElementById('gold-total').textContent = `${symbol}${goldTotal.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
                grandTotal += goldTotal;
            } else {
                document.getElementById('gold-total').textContent = '-';
            }
            
            // Calculate Silver
            const silverQty = parseFloat(document.getElementById('silver-quantity').value) || 0;
            if (rawPrices.silver.price && silverQty > 0) {
                const silverPrice = rawPrices.silver.price / conversion;
                const silverTotal = silverQty * silverPrice;
                document.getElementById('silver-total').textContent = `${symbol}${silverTotal.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
                grandTotal += silverTotal;
            } else {
                document.getElementById('silver-total').textContent = '-';
            }
            
            // Calculate BTC
            const btcQty = parseFloat(document.getElementById('btc-quantity').value) || 0;
            if (rawPrices.btc.price && btcQty > 0) {
                const btcTotal = btcQty * rawPrices.btc.price;
                document.getElementById('btc-total').textContent = `${symbol}${btcTotal.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
                grandTotal += btcTotal;
            } else {
                document.getElementById('btc-total').textContent = '-';
            }
            
            // Calculate XRP
            const xrpQty = parseFloat(document.getElementById('xrp-quantity').value) || 0;
            if (rawPrices.xrp.price && xrpQty > 0) {
                const xrpTotal = xrpQty * rawPrices.xrp.price;
                document.getElementById('xrp-total').textContent = `${symbol}${xrpTotal.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
                grandTotal += xrpTotal;
            } else {
                document.getElementById('xrp-total').textContent = '-';
            }
            
            // Update Grand Total
            if (grandTotal > 0) {
                document.getElementById('grand-total').textContent = `${symbol}${grandTotal.toLocaleString(undefined, {
                    minimumFractionDigits: 2,
                    maximumFractionDigits: 2
                })}`;
            } else {
                document.getElementById('grand-total').textContent = '-';
            }
        }
        
        // Fetch prices on load
        fetchPrices();
        
        // Refresh every 60 seconds
        setInterval(fetchPrices, 60000);
    </script>
    <script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/service-worker.js');
}
</script>
</body>
</html>
